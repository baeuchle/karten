<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  width="100%"
  height="100%"
  viewBox="0 50 740 600"
  onload="initialize()"
   >
   <title>Fahrradfahrten</title>
 <style type="text/css"><![CDATA[
  * { fill:none; stroke-width:1px; }
  text { fill:black; stroke: none; font-size: 12pt; }
  text.ylabel { text-anchor: end; }
  text.xlabel { text-anchor: middle; }

  #xaxis path, #yaxis path { stroke: #000000; stroke-width: 1; }
  #xaxis text { text-anchor: middle; border: thin black solid; }
  #yaxis text { text-anchor: end; }
  #xaxis text#xaxislabel, #yaxis text#yaxislabel { font-size: 120%; font-weight: bold; text-anchor: middle; }

  .datapoint { stroke: none; fill: #ff0000; fill-opacity: 1; }
  .dataarea { stroke: none; fill: #00c000; fill-opacity: .2; }
  .dataline  { stroke: #000080; fill: none; stroke-width: .5; }
  a { fill: #0000ff; }
 ]]>
 </style>
 <script type="application/ecmascript" id="constants"><![CDATA[
  var plotparams = {
    showPosition: false,
    keepPopup: -1,
    x: {
      min: new Date(2005, 0, 1, 0, 0, 0, 0),
      max: new Date(2017, 0, 1, 0, 0, 0, 0),
      del: 1,
      labeltext: "Jahr"
    },
    y: {
      min: 1000,
      max: 13000,
      del: 1000,
      labeltext: "km"
    },
    width: 640,
    height: 490
  };
  var plotlines = {
    pathdata: ""
  };

  function get_xpos(xDate) {
    var xoffset = xDate - plotparams.x.min;
    var xlength = plotparams.x.max - plotparams.x.min;
    return plotparams.width * xoffset / xlength;
  }

  function get_ypos(y) {
    return (-y + plotparams.y.min) / (plotparams.y.max - plotparams.y.min) * plotparams.height;
  }

  function get_size(element) {
    var localwidth = element.clientWidth || element.offsetWidth || element.scrollWidth;
    var localheight = element.clientHeight || element.offsetHeight || element.scrollHeight;
    if (!localwidth && !localheight) {
      localwidth = Number(element.getAttribute("width"));
      localheight = Number(element.getAttribute("height"));
    }
    if (!localwidth && !localheight) {
      var rect = element.getBoundingClientRect();
      var ul = document.documentElement.createSVGPoint();
      var dr = document.documentElement.createSVGPoint();
      ul.x = 0; ul.y = 0;
      dr.x = rect.width; dr.y = rect.height;
      var matrix = element.getScreenCTM().inverse();
      ul = ul.matrixTransform(matrix);
      dr = dr.matrixTransform(matrix);
      localwidth = Math.abs(dr.x - ul.x);
      localheight = Math.abs(dr.y - ul.y);
    }
    return { width: localwidth, height: localheight };
  }
 ]]></script>
 <script type="application/ecmascript" id="data"><![CDATA[
var fahrrad = [
 { date : new Date("2001-05-22"), distance :    0, link: "", text : "19. Geburtstag: Fahrrad bekommen" },
 { date : new Date("2005-09-03"), distance : 3390, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-04"), distance : 3452, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-05"), distance : 3542, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-06"), distance : 3619, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-07"), distance : 3705, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-08"), distance : 3778, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-09"), distance : 3851, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-10"), distance : 3930, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-11"), distance : 3990, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-12"), distance : 4073, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-13"), distance : 4121, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-14"), distance : 4199, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-15"), distance : 4297, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-16"), distance : 4371, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-17"), distance : 4463, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-18"), distance : 4573, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-19"), distance : 4672, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2005-09-20"), distance : 4752, link: "", text : "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date : new Date("2006-06-20"), distance : 5901, link: "http://baeuchle.frankfurtium.de/2006-06/projekt-6000/", text: "Projekt 6000" },
 { date : new Date("2006-06-21"), distance : 5916, link: "http://baeuchle.frankfurtium.de/2006-06/projekt-6000/", text: "Projekt 6000" },
 { date : new Date("2006-06-22"), distance : 5928, link: "http://baeuchle.frankfurtium.de/2006-06/projekt-6000/", text: "Projekt 6000" },
 { date : new Date("2006-06-27"), distance : 5953, link: "http://baeuchle.frankfurtium.de/2006-06/projekt-6000/", text: "Projekt 6000" },
 { date : new Date("2006-07-13"), distance : 6009, link: "http://baeuchle.frankfurtium.de/2006-06/projekt-6000/", text: "Projekt 6000" },
 { date : new Date("2006-08-26"), distance : 6300, link: "http://baeuchle.frankfurtium.de/2006-08/projekt-7000/", text: "Projekt 7000" },
 { date : new Date("2006-09-10"), distance : 6500, link: "http://baeuchle.frankfurtium.de/2006-09/halbe-miete-und-handys/", text: "Halbe Miete und Handys" },
 { date : new Date("2006-10-31"), distance : 6888, link: "http://baeuchle.frankfurtium.de/2006-10/ruskevaer/", text: "Ruskevær" },
 { date : new Date("2006-12-05"), distance : 7013, link: "", text: "Quelle: Kalender" },
 { date : new Date("2006-12-06"), distance : 7025, link: "", text: "Quelle: Kalender" },
 { date : new Date("2006-12-07"), distance : 7035, link: "", text: "Quelle: Kalender" },
 { date : new Date("2006-12-08"), distance : 7045, link: "", text: "Quelle: Kalender" },
 { date : new Date("2007-07-16"), distance : 7355, link: "http://baeuchle.frankfurtium.de/2007-07/siste-innforing-om-norge/", text: "Siste Innføring om Norge" },
 { date : new Date("2008-09-05"), distance : 7977, link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date : new Date("2008-09-06"), distance : 8046, link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date : new Date("2008-09-07"), distance : 8146, link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date : new Date("2008-09-08"), distance : 8294, link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date : new Date("2008-09-09"), distance : 8376, link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date : new Date("2009-07-06"), distance : 9208, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-07"), distance : 9239, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-08"), distance : 9365, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-09"), distance : 9437, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-10"), distance : 9540, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-11"), distance : 9696, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-12"), distance : 9782, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-13"), distance : 9863, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-14"), distance : 9855, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-15"), distance :10008, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-16"), distance :10116, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-17"), distance :10216, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2009-07-18"), distance :10255, link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date : new Date("2012-01-06"), distance :10882, link: "http://baeuchle.frankfurtium.de/2012-01/projekt-11000/", text: "Projekt 11000" },
 { date : new Date("2012-02-28"), distance :11000, link: "http://baeuchle.frankfurtium.de/2012-03/tagestrip-nach-amsterdam/", text: "Tagestrip nach Amsterdam" },
 { date : new Date("2012-03-12"), distance :11162, link: "http://baeuchle.frankfurtium.de/2012-03/tagestrip-nach-amsterdam/", text: "Tagestrip nach Amsterdam" },
 { date : new Date("2012-04-05"), distance :11400, link: "http://baeuchle.frankfurtium.de/2012-04/fleischlos/", text: "Fleischlos" },
 { date : new Date("2012-04-25"), distance :11600, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-04-26"), distance :11652, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-04-27"), distance :11757, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-04-28"), distance :11828, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-04-29"), distance :11891, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-04-30"), distance :11920, link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein", text: "Niederrhein (Stand geschätzt)" },
 { date : new Date("2012-10-10"), distance :12569, link: "http://baeuchle.frankfurtium.de/2012-10/projekt-13000-und-weitere-plaene-fuer-2012/", text: "Projekt 13000 und weitere Pläne für 2012" },
 { date : new Date("2012-12-20"), distance :13000, link: "http://baeuchle.frankfurtium.de/2012-12/projekt-14000/", text: "Projekt 14000" },
 { date : new Date("2013-02-26"), distance :13013, link: "http://baeuchle.frankfurtium.de/2013-02/statistik-2012/", text: "Statistik 2012" },
 { date : new Date("2013-02-28"), distance :13041, link: "http://baeuchle.frankfurtium.de/2013-02/statistik-2012/", text: "Statistik 2012" },
 { date : new Date("2013-04-02"), distance :13055, link: "http://baeuchle.frankfurtium.de/2013-04/fleischlos-und-kein-alkohol/", text: "Fleischlos und kein Alkohol" },
 { date : new Date("2013-04-08"), distance :13067, link: "http://baeuchle.frankfurtium.de/2013-05/alles-neu-macht-der-mai/", text: "Alles neu macht der Mai" },
 { date : new Date("2013-05-12"), distance :    0, link: "http://baeuchle.frankfurtium.de/2013-05/alles-neu-macht-der-mai/", text: "Alles neu macht der Mai" },
 { date : new Date("2013-12-31"), distance :  805, link: "http://baeuchle.frankfurtium.de/2014-02/auf-nach-niederursel/", text: "Auf nach Niederursel" },
 { date : new Date("2014-08-09"), distance : 2050, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-10"), distance : 2141, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-11"), distance : 2186, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-12"), distance : 2273, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-13"), distance : 2373, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-14"), distance : 2465, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-15"), distance : 2561, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2014-08-16"), distance : 2627, link: "", text: "Mainradweg (Stand geschätzt)" },
 { date : new Date("2015-01-05"), distance : 3759, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-01-12"), distance : 3828, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-01-19"), distance : 3869, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-01-26"), distance : 3901, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-02-02"), distance : 3949, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-02-09"), distance : 3991, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-02-16"), distance : 4039, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-02-23"), distance : 4147, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-02"), distance : 4208, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-09"), distance : 4354, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-16"), distance : 4407, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-23"), distance : 4478, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-30"), distance : 4540, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-03-31"), distance : 4542, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-04-26"), distance : 4559, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-05-03"), distance : 4593, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-05-10"), distance : 4678, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-05-22"), distance : 4759, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-05-24"), distance : 4807, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-06-07"), distance : 4908, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-06-14"), distance : 4960, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-06-21"), distance : 5047, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-06-28"), distance : 5111, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-07-05"), distance : 5203, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-07-12"), distance : 5361, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-07-19"), distance : 5487, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-07-26"), distance : 5549, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-02"), distance : 5612, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-09"), distance : 5666, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-16"), distance : 5735, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-18"), distance : 5759, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-23"), distance : 5777, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-08-30"), distance : 5778, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-09-06"), distance : 5778, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-09-13"), distance : 5791, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-09-20"), distance : 5942, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-09-27"), distance : 5948, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-10-04"), distance : 6019, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-10-11"), distance : 6025, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-10-18"), distance : 6039, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-10-25"), distance : 6039, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-11-01"), distance : 6046, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-11-08"), distance : 6064, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-11-15"), distance : 6073, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-11-22"), distance : 6076, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-11-29"), distance : 6086, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2015-12-06"), distance : 6093, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-01-03"), distance : 6093, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-01-10"), distance : 6103, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-01-17"), distance : 6126, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-02-07"), distance : 6126, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-02-14"), distance : 6171, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-02-21"), distance : 6178, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-02-28"), distance : 6200, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-03-06"), distance : 6214, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-03-13"), distance : 6229, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-04-10"), distance : 6255, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-04-24"), distance : 6262, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-05-01"), distance : 6269, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-05-08"), distance : 6281, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-05-15"), distance : 6307, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-05-22"), distance : 6340, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-05-29"), distance : 6354, link: "", text: "Quelle: Protokoll" },
 { date : new Date("2016-06-05"), distance : 6372, link: "", text: "Quelle: Protokoll" }
];
var regionen = [
 { date: [ new Date("2005-09-03"), new Date("2005-09-20")], dateText: "September 2005", km: [ 3390,  4752], link: "", text: "Fahrradtour zur Ostsee mit Caro und Derek B." },
 { date: [ new Date("2006-08-02"), new Date("2007-07-16")], dateText: "Aug 2008 - Jun 2007", km: [ 6020,  7355], link: "http://baeuchle.frankfurtium.de/tags/norge/", text: "Jahr in Norwegen" },
 { date: [ new Date("2008-09-05"), new Date("2008-09-09")], dateText: "September 2008", km: [ 7977,  8376], link: "http://baeuchle.frankfurtium.de/2008-11/fahrradurlaub-am-rhein/", text: "Fahrradurlaub am Rhein" },
 { date: [ new Date("2009-07-06"), new Date("2009-07-18")], dateText: "Juli 2009", km: [ 9208, 10255], link: "http://baeuchle.frankfurtium.de/2010-03/norwegen-2009/", text: "Norwegen 2009" },
 { date: [ new Date("2012-04-25"), new Date("2012-04-30")], dateText: "April 2012", km: [11600, 11920], link: "http://baeuchle.frankfurtium.de/2012-05/niederrhein/", text: "Niederrhein (Stand geschätzt)" },
 { date: [ new Date("2013-04-13"), new Date("2013-05-12")], dateText: "Mai 2013", km: [ 3266,  9800], kmText: " ", link: "http://baeuchle.frankfurtium.de/2013-05/alles-neu-macht-der-mai/", text: "Neues Fahrrad" },
 { date: [ new Date("2014-08-09"), new Date("2014-08-16")], dateText: "August 2014", km: [ 2050,  2627], link: "", text: "Mainradweg (Stand geschätzt)" },
 ];
 ]]></script>
 <script type="application/ecmascript" id="initialize_data"><![CDATA[
  function drawData() {
    regionen.forEach(drawRegion);
    plotlines.pathdata = "M ";
    fahrrad.forEach(drawPoint);
    plotlines.pathdata = plotlines.pathdata.substr(0, plotlines.pathdata.length - 2);
    var pathobj = document.createElementNS("http://www.w3.org/2000/svg", 'path');
    pathobj.setAttribute("d", plotlines.pathdata);
    pathobj.setAttribute("class", "dataline");
    var area = document.getElementById("dataarea");
    area.insertBefore(pathobj, area.firstChild);
  }

  function drawRegion(value, index, daten) {
    var area = document.createElementNS("http://www.w3.org/2000/svg", 'ellipse');
    document.getElementById("dataarea").appendChild(area);
    area.setAttribute("class", "dataarea");
    area.setAttribute("id", "area" + index);
    var lowx = get_xpos(value.date[0]) / 2;
    var hihx = get_xpos(value.date[1]) / 2;
    var midx = lowx + hihx;
    var lowy = get_ypos(value.km[0]) / 2;
    var hihy = get_ypos(value.km[1]) / 2;
    var midy = lowy + hihy;
    area.setAttribute("rx", Math.max(20, 5 + Math.abs(hihx - lowx)));
    area.setAttribute("ry", Math.max(20, 5 + Math.abs(hihy - lowy)));
    area.setAttribute("cx", midx);
    area.setAttribute("cy", midy);
    area.setAttribute("onmouseover", "showpoint(make_datapoint(regionen[" + index + "]), evt)");
    area.setAttribute("onmouseout", "hidepoint(make_datapoint(regionen[" + index + "]))");
  }

  function make_datapoint(region) {
    var midx = (region.date[0].getTime() + region.date[1].getTime()) / 2;
    var midy = (region.km[0] + region.km[1]) / 2;
    return {
      date: new Date(midx),
      datetext: region.dateText,
      distance: midy,
      kmtext: region.kmText ? region.kmText : region.km[0] + "km – " + region.km[1] + " km",
      text: region.text,
      link: region.link
    };
  }

  function drawPoint(value, index, daten) {
    var point = document.createElementNS("http://www.w3.org/2000/svg", 'circle'); 
    document.getElementById("dataarea").appendChild(point);
    point.setAttribute("class", "datapoint");
    point.setAttribute("id", "data" + index);
    point.setAttribute("r", "2");
    point.setAttribute("cx", get_xpos(value.date));
    point.setAttribute("cy", get_ypos(value.distance));
    point.setAttribute("onmouseover", "showpoint(fahrrad[" + index + "], evt)");
    point.setAttribute("onmouseout", "hidepoint(fahrrad[" + index + "])");
    point.setAttribute("onclick", "keep(" + index + ")");
    plotlines.pathdata += "" + get_xpos(value.date) + "," + get_ypos(value.distance) + " L ";
  }
 ]]></script>
 <script type="application/ecmascript" id="initialize"><![CDATA[
  function initialize() {
     drawXaxis(document.getElementById("xaxis"))
     drawYaxis(document.getElementById("yaxis"))
     drawData();
  }

  function drawXaxis(group) {
    for (var x = plotparams.x.min.getFullYear(); x <= plotparams.x.max.getFullYear(); x += plotparams.x.del) {
      var label = document.createElementNS("http://www.w3.org/2000/svg", 'text');
      var tic = document.createElementNS("http://www.w3.org/2000/svg", 'path');
      group.appendChild(label);
      group.appendChild(tic);

      var xDate = new Date(x, 0, 1, 0, 0, 0, 0);
      var xpos = get_xpos(xDate);
      label.textContent = x;
      label.setAttribute("x", xpos);
      label.setAttribute("y", 1.5 * get_size(label).height);
      tic.setAttribute("d", "M " + xpos + ",0 v -5");
    }
    var axislabel = document.createElementNS("http://www.w3.org/2000/svg", 'text');
    group.appendChild(axislabel);
    axislabel.textContent = plotparams.x.labeltext;
    axislabel.setAttribute("id", "xaxislabel");
    axislabel.setAttribute("x", plotparams.width / 2);
    axislabel.setAttribute("y", 1.5 * get_size(group.firstChild).height + get_size(axislabel).height);
  }

  function drawYaxis(group) {
    for (var y = plotparams.y.min; y <= plotparams.y.max; y += plotparams.y.del) {
      var label = document.createElementNS("http://www.w3.org/2000/svg", 'text');
      group.appendChild(label);
      var tic = document.createElementNS("http://www.w3.org/2000/svg", 'path');
      group.appendChild(tic);

      var ypos = get_ypos(y);
      label.textContent = y;
      label.setAttribute("y", ypos + get_size(label).height / 3);
      label.setAttribute("x", - get_size(label).height / 2);
      tic.setAttribute("d", "M 0," + ypos + " h 5");
    }
    var axislabel = document.createElementNS("http://www.w3.org/2000/svg", 'text');
    group.appendChild(axislabel);
    axislabel.textContent = plotparams.y.labeltext;
    var x = - get_size(group.lastChild.previousSibling.previousSibling).width - 5;
    var y = -plotparams.height / 2;
    axislabel.setAttribute("transform", "translate(" + x + "," + y + ") rotate(-90)");
    axislabel.setAttribute("id", "yaxislabel");
  }
 ]]></script>
 <script type="application/ecmascript" id="show_coordinates"><![CDATA[
  function toggle_coordinateshow(evt) {
    plotparams.showPosition = !plotparams.showPosition;
    document.getElementById("koordinaten").setAttribute("visibility", plotparams.showPosition ? 'shown' : 'hidden');
    showcoordinates(evt);
  }

  function showcoordinates(evt) {
    if (! plotparams.showPosition) {
      return;
    }
    var coordinate_point = getCoordinatePoint(evt);

    // plot_point is between 0 and 1 for both dimensions:
    var plot_point = document.documentElement.createSVGPoint();
    plot_point.x =  coordinate_point.x / plotparams.width;
    plot_point.y = -coordinate_point.y / plotparams.height;
    var date = new Date(plotparams.x.min.getTime() + (plotparams.x.max.getTime() - plotparams.x.min.getTime())*plot_point.x);
    var xText = dateFormat(date);
    var yText = (plot_point.y * plotparams.y.max + plotparams.y.min).toFixed(2) + " km";

    var textElement = document.getElementById("koordinaten");
    textElement.firstChild.data = yText + " / " + xText;
    textElement.setAttribute("y", get_size(textElement).height);

    // positioning of text field:
    setNodePosition(textElement, textElement, coordinate_point);
  }

  // node: the element whose position is set
  // sizer: the element whose size is used,
  // position: the position of the mouse
  function setNodePosition(node, sizer, position) {
    var x;
    var y;
    var localsize = get_size(sizer);
    if (localsize.width + position.x > plotparams.width - 10) {
      x = position.x - 10 - localsize.width;
    } else {
      x = position.x + 10;
    }

    if (localsize.height + position.y > -5) {
      y = - (localsize.height + 2);
    } else {
      y = position.y + 2;
    }
    node.setAttribute("transform", "translate(" + x + "," + y + ")");
  }

  function dateFormat(date) 
  {
    return ("0" + date.getDate()).slice(-2) + "." + ("0" + (date.getMonth() + 1)).slice(-2) + "." + date.getFullYear();
  }

  function getCoordinatePoint(evt) {
    var coordinate_matrix = evt.target.getScreenCTM().inverse();
    var client_point = document.documentElement.createSVGPoint();
    client_point.x = evt.clientX;
    client_point.y = evt.clientY;
    return client_point.matrixTransform(coordinate_matrix);
  }
 ]]></script>
 <script type="application/ecmascript" id="showdata"><![CDATA[
   function showpoint(data, evt) {
     var datainfogroup = document.getElementById("datainfo");
     datainfogroup.setAttribute("visibility", "shown");
     if (plotparams.keepPopup >= 0) {
       return;
     }
     document.getElementById("koordinaten").setAttribute("visibility", 'hidden');
     var bg_rect = document.getElementById("datainfo_background");
     var date_text = document.getElementById("datainfo_date");
     var dist_text = document.getElementById("datainfo_value");
     var desc_text = document.getElementById("datainfo_description");
     date_text.textContent = data.datetext ? data.datetext : dateFormat(data.date);
     dist_text.textContent = data.kmtext ? data.kmtext : (data.distance + " km");
     while (desc_text.firstChild) {
       desc_text.removeChild(desc_text.firstChild);
     }
     if (! data.link) {
       desc_text.textContent = data.text;
     } else {
       desc_text.textContent = null;
       var link = document.createElementNS("http://www.w3.org/2000/svg", 'a');
       link.href = data.link;
       link.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", data.link);
       link.setAttribute("target", "_parent");
       link.textContent = data.text;
       desc_text.appendChild(link);
     }
     var dateSize = get_size(date_text);
     var distSize = get_size(dist_text);
     var descSize = get_size(desc_text);
     date_text.setAttribute("y", 1.5 + dateSize.height);
     dist_text.setAttribute("y", 1.5 + dateSize.height + distSize.height);
     desc_text.setAttribute("y", 1.5 + dateSize.height + distSize.height + descSize.height);

     var maxwidth = Math.max(dateSize.width, distSize.width, descSize.width);
     bg_rect.setAttribute("width", 6 + maxwidth);
     bg_rect.setAttribute("height", 6 + dateSize.height + distSize.height + descSize.height);
     setNodePosition(datainfogroup, bg_rect, getCoordinatePoint(evt));
   }

   function keep(index) {
     if (plotparams.keepPopup == index) {
       plotparams.keepPopup = -1;
       hidepoint(plotparams.keepPopup);
       return;
     }
     plotparams.keepPopup = index;
   }
  
   function hidepoint(index) {
     if (plotparams.keepPopup != -1) {
       return;
     }
     plotparams.keepPopup = -1;
     document.getElementById("koordinaten").setAttribute("visibility", plotparams.showPosition ? 'shown' : 'hidden');
     var datainfogroup = document.getElementById("datainfo");
     datainfogroup.setAttribute("visibility", "hidden");
   }
 ]]></script>
 <g id="coord" transform="translate(80,550)">
  <rect x="0" y="-490" height="490" width="640" style="fill: #ffffe0; stroke: #000000; fill-opacity:.3" onclick="toggle_coordinateshow(evt)" onmousemove="showcoordinates(evt)"/>
  <g id="axes">
   <g id="xaxis" />
   <g id="yaxis" />
  </g>
  <g id="dataarea" />
  <g id="datainfo">
    <rect id="datainfo_background" x="0" y="0" style="fill: #ffffff; stroke: #000000; stroke-width: 1; " onclick="keep(-1); hidepoint(-1)"/>
    <text id="datainfo_date" x="3" />
    <text id="datainfo_value" x="3" />
    <text id="datainfo_description" x="3" />
  </g>
  <text id="koordinaten" visibility="hidden">Koordinaten</text>
 </g>
</svg>
